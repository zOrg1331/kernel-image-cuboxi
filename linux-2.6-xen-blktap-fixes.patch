diff --exclude-from=/dev/fd/63 -ur linux-2.6.18.noarch/drivers/xen/blktap/Makefile kernel-2.6.18.blktap/linux-2.6.18.noarch/drivers/xen/blktap/Makefile
--- linux-2.6.18.noarch/drivers/xen/blktap/Makefile	2006-09-25 21:32:06.000000000 +0100
+++ kernel-2.6.18.blktap/linux-2.6.18.noarch/drivers/xen/blktap/Makefile	2006-09-21 20:25:09.000000000 +0100
@@ -1,3 +1,6 @@
 LINUXINCLUDE += -I../xen/include/public/io
-obj-y	:= xenbus.o interface.o blktap.o 
+
+obj-$(CONFIG_XEN_BLKDEV_TAP) := blktap.o
+
+blktap-y	:= xenbus.o interface.o blktapmain.o 
 
--- linux-2.6.18.noarch/drivers/xen/blktap/blktap.c.~1~	2006-10-17 20:12:00.000000000 +0100
+++ linux-2.6.18.noarch/drivers/xen/blktap/blktap.c	2006-10-17 20:28:53.000000000 +0100
@@ -1361,8 +1361,6 @@
 		info->blkif = NULL;
 
 		info->dev_pending = info->dev_inuse = 0;
-
-		DPRINTK("Created misc_dev [/dev/xen/blktap%d]\n",i);
 	}
 
 	/* Make sure the xen class exists */
diff -r ec03b24a2d83 -r 6ca424e1867e linux-2.6-xen-sparse/mm/memory.c
--- linux-2.6-xen-sparse/mm/memory.c    Tue Aug 15 19:53:55 2006 +0100
+++ linux-2.6-xen-sparse/mm/memory.c    Fri Aug 18 16:17:58 2006 -0400
@@ -881,6 +881,7 @@ unsigned long zap_page_range(struct vm_a
                tlb_finish_mmu(tlb, address, end);
        return end;
 }
+EXPORT_SYMBOL(zap_page_range);

 /*
  * Do a quick page-table lookup for a single page.
