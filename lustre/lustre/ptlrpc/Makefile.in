MODULES := ptlrpc
LDLM := @top_srcdir@/lustre/ldlm/
ldlm_objs := $(LDLM)l_lock.o $(LDLM)ldlm_lock.o 
ldlm_objs += $(LDLM)ldlm_resource.o $(LDLM)ldlm_lib.o
ldlm_objs += $(LDLM)ldlm_plain.o $(LDLM)ldlm_extent.o
ldlm_objs += $(LDLM)ldlm_request.o $(LDLM)ldlm_lockd.o
ldlm_objs += $(LDLM)ldlm_flock.o $(LDLM)ldlm_inodebits.o
ldlm_objs += $(LDLM)ldlm_pool.o
ldlm_objs += $(LDLM)interval_tree.o
ptlrpc_objs := client.o recover.o connection.o niobuf.o pack_generic.o
ptlrpc_objs += events.o ptlrpc_module.o service.o pinger.o recov_thread.o
ptlrpc_objs += llog_net.o llog_client.o llog_server.o import.o ptlrpcd.o
ptlrpc_objs += pers.o lproc_ptlrpc.o wiretest.o

ptlrpc-objs := $(ldlm_objs) $(ptlrpc_objs)

default: all

ldlm_%.c: @LUSTRE@/ldlm/ldlm_%.c
	ln -sf $< $@

l_lock.c: @LUSTRE@/ldlm/l_lock.c
	ln -sf $< $@

interval_tree.c: @LUSTRE@/ldlm/interval_tree.c
	ln -sf $< $@

EXTRA_DIST = $(ptlrpc_objs:.o=.c) ptlrpc_internal.h
EXTRA_PRE_CFLAGS := -I@LUSTRE@/ldlm

@INCLUDE_RULES@
